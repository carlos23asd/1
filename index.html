<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Compartir pantalla con SRS</title>
</head>
<body style="text-align:center; background:#111; color:white;">
  <h2>üñ•Ô∏è Compartir pantalla a SRS v√≠a WebRTC</h2>
  <video id="video" autoplay muted playsinline style="width: 480px; border: 2px solid red;"></video>
  <br>
  <button id="btnShare" disabled>Esperando librer√≠a...</button>

  <!-- ‚úÖ Librer√≠a oficial de SRS -->
  <script src="https://cdn.jsdelivr.net/npm/srs-sdk@1.0.37/webrtc-adaptor.min.js" onload="init()"></script>

  <script>
    function init() {
      console.log("‚úÖ Librer√≠a cargada correctamente");
      const button = document.getElementById('btnShare');
      button.innerText = "Compartir pantalla";
      button.disabled = false;
      button.onclick = startShare;
    }

    async function startShare() {
      try {
        const stream = await navigator.mediaDevices.getDisplayMedia({ video: true });
        document.getElementById('video').srcObject = stream;

        const adaptor = new SrsRtcPublisherAsync();

        adaptor.onpublish = () => {
          console.log("‚úÖ Transmisi√≥n iniciada");
          alert("¬°Compartiendo pantalla en vivo!");
        };

        adaptor.onerror = (e) => {
          console.error("‚ùå Error al transmitir:", e);
          alert("Error en la transmisi√≥n");
        };

        await adaptor.publish("webrtc://168.231.71.30/live/stream", stream); // Reemplaza IP si es necesario
      } catch (err) {
        console.error("Error al capturar pantalla:", err);
        alert("No se pudo capturar la pantalla.");
      }
    }
  </script>
</body>
</html>
