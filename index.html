<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Compartir pantalla a SRS sin librer√≠as</title>
</head>
<body style="text-align:center; background:#111; color:white;">
  <h2>üñ•Ô∏è Compartir pantalla v√≠a WebRTC (sin librer√≠as)</h2>
  <video id="video" autoplay muted playsinline style="width: 480px; border: 2px solid red;"></video>
  <br>
  <button onclick="startShare()">Compartir pantalla</button>

  <script>
    const api = 'http://168.231.71.30:1985/rtc/v1/publish/'; // ‚ö†Ô∏è Cambia por tu IP si es distinta
    const streamUrl = 'webrtc://168.231.71.30/live/stream';   // ‚ö†Ô∏è Igual aqu√≠

    async function startShare() {
      try {
        const stream = await navigator.mediaDevices.getDisplayMedia({ video: true });
        document.getElementById('video').srcObject = stream;

        const pc = new RTCPeerConnection(null);
        stream.getTracks().forEach(track => pc.addTrack(track, stream));

        const offer = await pc.createOffer();
        await pc.setLocalDescription(offer);

        const url = `${api}?sdp=${encodeURIComponent(offer.sdp)}&streamurl=${encodeURIComponent(streamUrl)}&clientip=`;

        const response = await fetch(url, { method: 'POST' });
        const data = await response.json();

        await pc.setRemoteDescription(new RTCSessionDescription({ type: 'answer', sdp: data.sdp }));

        console.log('‚úÖ Transmisi√≥n WebRTC iniciada con √©xito.');
        alert('¬°Pantalla compartida con SRS!');
      } catch (err) {
        console.error('‚ùå Error al compartir pantalla:', err);
        alert('No se pudo iniciar la transmisi√≥n.');
      }
    }
  </script>
</body>
</html>

